<h1 style="color:#696969;" class="text-center">Order# <%= @order.id %> <small>Summary</small></h1>

<table style="color:#696969;" onclick="toggle_visibility('foo')"><tr><td class="pointer text-center"><a>Click for Tracking Information</a></td></tr></table>

<table style="color:#696969;" id="foo">
  <tr>
    <th>Tracking No</th>
    <th>Quantity Disptached</th>
    <th>Disptached</th>
    <th>Order Status</th>
  </tr>
<% @order.consignments.each do |c| %>
  <tr>
    <td><b></b> <%= c.tracking_no == "" ? "Provided Upon Disptach" : c.tracking_no %></td>
    <td><b></b> <%= c.dispatched_quantity %></td>
    <td><b></b> <%= c.shipped_at.strftime("%A, %e %b - %H:%M %p") %></td>
    <td><b></b> <%= c.status %></td>
  </tr>
<% end %>
  <tr><td></td><td></td><td></td><td></td></tr>

</table>

<table style="color:#696969;">
  <tr>
    <th>Shipping Address</th>
    <th>Details</th>
    <th>Order Notes</th>
  </tr>
  <tr>
    <% @split = @order.address.split(',') %>
    <td> <p><%= raw @split.join("<br />") %></p> </td>
    <td>
      Order for: <b><%= current_user.forname %></b><br>
      Company: <b><%= current_user.company ? current_user.company.name : "Nil" %></b><br>
      Order Date: <b><%= @order.created_at.strftime("%A, %b %d") %></b><br>
      Order Time: <b><%= @order.created_at.strftime("%H:%M:%S") %></b><br>
    </td>
    <td>
      <%= @order.notes %>
    </td>
  </tr>
</table>

<table style="color:#696969;">
  <tr>
    <th>Product Code</th>
    <th>Name</th>
    <th>Description</th>
    <th>Unit Price</th>
    <th>Quantity</th>
    <th>Pack Size</th>
    <th>Total Price</th>
  </tr>
<% if @order_items.any? %>
<% @order_items.each do |item| %>
  <tr>
    <td><%= item.product.product_code %></td>
    <td><%= item.product.name %></td>
    <td><%= item.product.description %></td>
    <td><%= number_to_currency item.product.price %></td>
    <td><%= item.quantity %></td>
    <td><%= item.product.pack_size %></td>
    <td><%= number_to_currency item.product.price * item.quantity.to_i %></td>
  </tr>
  <% end %>
  <tr>
    <th><%= link_to "My Orders", orders_path, class: "btn btn-info" %></th>
    <th><%= link_to "Order Again", reorder_path, class: "btn btn-success" %></th>
    <td><% if @order.status == "Ordered" %>
    <%= link_to "Edit Orders", edit_order_path(@order), class: "btn btn-warning" %>
    <% end %></td>
    <td colspan="3" class="text-right"><b>Your Order Total:</b></td>
    <td colspan="5"><b> <%=number_to_currency @order.calculate_total %> <%#= current_order.calculate_total %></b></td>
  </tr>
  <% end %>
</table>

<script>
  function toggle_visibility(id) {
     var e = document.getElementById(id);
     if(e.style.display == 'inline-table')
        e.style.display = 'none';
     else
        e.style.display = 'inline-table';
  }
</script>

<style>
#foo {
  display:none;
  margin:0;
}

.pointer {
  cursor:pointer;
}
table {
    /*font-family: arial, sans-serif;*/
    border-collapse: collapse;
    width: 100%;
}

td, th {
    border: 1px solid #dddddd;
    text-align: left;
    padding: 8px;
}

tr:nth-child(even) {
    background-color: #dddddd;
}
</style>
