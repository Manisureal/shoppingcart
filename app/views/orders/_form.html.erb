<%= simple_form_for @order do |f| %>
<div class="container">
  <div class="row pad-top-bot">
    <div class="col-md-4 dark-grey">
      <h4>Shipping Address</h4>
      <%= f.text_area :address %>
    </div>
    <div class="col-md-4 text-center dark-grey"><br><br>
      <h4>Order for <b><%= current_user.forname %></b></h4>
      <h4>Company: <b><%= current_user.company ? current_user.company.name : "Nil" %></b></h4>
      <h4>Order Date: <b><%= Time.now.strftime("%A, %b %d") %></b></h4>
      <h4>Order Time: <b><%= Time.now.strftime("%H:%M:%S") %></b></h4>

    </div>
    <div class="col-md-4 text-right dark-grey">
      <h4>Order Notes</h4>
      <%= f.text_area :notes %>
    </div>
  </div>


  <div class="row text-center dark-grey" style="background-color:;">
    <div class="col-md-2">
        <h4>Product</h4>
    </div>
    <div class="col-md-2">
        <h4>Quantity</h4>
    </div>
    <div class="col-md-2">
        <h4>Code</h4>
    </div>
    <div class="col-md-2">
        <h4>Pack Size</h4>
    </div>
    <div class="col-md-2">
        <h4>Price</h4>
    </div>
    <div class="col-md-2">
        <h4>Current Total</h4>
    </div>
  </div>
  <% my_counter = 0 %>
    <%= f.fields_for :order_items do |oi| %>
  <div class="row bg-color">
    <div class="col-md-2">
      <td><%= oi.select(:product_id, Product.all.collect { |p| [p.name, p.id] }, {include_blank: "Select One"}, {class: "product-selector form-control selectpicker", data: {counter_id: my_counter}} ) %></td>
    </div>
    <div class="col-md-2">
      <%= oi.text_field :quantity, class: "quan-tot form-control", data: {counter_id: my_counter } %>
    </div>
    <div class="col-md-2">
      <input id="product-code-<%= my_counter %>" class="form-control" value="<%= oi.object.product ? oi.object.product.product_code : "" %>" disabled>
    </div>
    <div class="col-md-2">
      <input id="pack-size-<%= my_counter %>" class="form-control" value="<%= oi.object.product ? oi.object.product.pack_size : "" %>"  disabled>
    </div>
    <div class="col-md-2">
      <input id="price-<%= my_counter %>" class="form-control" value="<%= oi.object.product ? oi.object.product.price : "" %>" disabled>
    </div>
    <div class="col-md-2">
      <div class="input-group"><span class="input-group-addon">£</span><input class="order-item-total form-control" id="total-<%= my_counter %>" value="<%= oi.object.total %>" disabled></div>
    </div>
  </div>
    <% my_counter = my_counter.to_i + 1 %>
    <% end %>
  <div class="row pad-top-bot" style="background-color:#fffafa;">
    <div class="col-md-2">
      <%= f.submit "Submit Order", class: "btn btn-primary"%>
  <% end %>
    </div>
    <div class="col-md-2"><%= link_to "My Orders", orders_path, class: "btn btn-warning" %></div>
    <div class="col-md-2"></div>
    <div class="col-md-2"></div>
    <div class="col-md-2 text-right">
      <strong class="dark-grey">Total: </strong>
    </div>
    <div class="col-md-2">
      <div class="input-group">
        <span class="input-group-addon">£</span>
        <input type="text" class="form-control" value="<%= @order.calculate_total %>" id="total-order-value" disabled>
      </div>
    </div>
  </div>
</div>

<!-- <div class="col-xs-12 col-md-8">
  <%#= form_for @order do |f| %>
    <%# if @order.errors.any? %>
      <div class="errors-container">
        <ul>
          <%# @order.errors.full_messages.each do |order| %>
            <li><%#= order %></li>
          <%# end %>
        </ul>
      </div>
    <%# end %>
    <%#= f.text_area :notes %>
    <%# my_counter = 0 %>
    <%#= f.fields_for :order_items do |oi| %>
      <div id="order-item-container">
      <%#= render partial: "order_item", locals: { oi: oi, counter: my_counter } %>
      <%# my_counter = my_counter.to_i + 1 %>
      </div>
    <%# end %>
    <strong>Total: </strong><input type="text" value="<%= @order.calculate_total %>" id="total-order-value" disabled><br>
    <%#= f.submit "Submit Order" %>
  <%# end %>
</div> -->

<script>
  <%= raw render partial: "orders.js" %>
</script>

<!-- <script>
  window.onload = function() {
  $('document').ready(function(){
    $('.selectpicker').selectpicker({
      style: 'btn-info',
      size: 4
    });
  });
}
</script> -->

<style>
  .pad-top-bot {
    padding: 20px 0;
  }

  .dark-grey {
    /*color:#8b8989;*/
    color:#696969;
  }

  .container {
    width:100%;
  }

  textarea {
    width:250px;
    height:180px;
    padding:10px;
    border:none;
    box-shadow:3px 4px 24px -4px rgba(92,92,92,0.79);
  }
  textarea:focus {
    background: grey;
    color:white;
  }
  /*.bg-color:nth-child(even) {
    background-color: #dddddd;
  }

  .bg-color:nth-child(odd) {
    background-color: white;
  }*/

  .bg-color {
    background-color: white;
    padding: 10px 0;
  }
</style>
